# Copyright (c) 2021 Vincent A. Cicirello
# MIT License

name: Update Major Release Tag

on:
  release:
    types: [created]

jobs:
  move-tag:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Update Major Version
      id: major-version
      run: |
        VERSION=${GITHUB_REF#refs/tags/}
        MAJOR=${VERSION%%.*}
        git tag -fa "$MAJOR" -m "Update major version tag $MAJOR"
        git push origin "$MAJOR" --force
        echo "version=$MAJOR" >> "$GITHUB_OUTPUT"
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
